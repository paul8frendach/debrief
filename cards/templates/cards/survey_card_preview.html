{% extends 'cards/base.html' %}

{% block title %}Review Your Card - Debrief{% endblock %}

{% block extra_style %}
.preview-container {
    max-width: 1400px;
    margin: 60px auto;
    padding: 0 20px;
}

.preview-header {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    border-radius: 16px;
    padding: 40px;
    margin-bottom: 32px;
    color: white;
    text-align: center;
}

.header-icon {
    font-size: 64px;
    margin-bottom: 16px;
}

.header-title {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 12px;
}

.header-subtitle {
    font-size: 16px;
    opacity: 0.95;
}

.preview-layout {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 24px;
}

.card-preview {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    border-radius: 16px;
    padding: 40px;
    border: 1px solid rgba(255,255,255,0.1);
}

.card-header {
    margin-bottom: 32px;
    padding-bottom: 24px;
    border-bottom: 2px solid rgba(255,255,255,0.1);
}

.card-title {
    font-size: 28px;
    font-weight: 800;
    color: white;
    margin-bottom: 16px;
    line-height: 1.3;
}

.card-meta {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
}

.meta-badge {
    padding: 8px 16px;
    border-radius: 12px;
    font-size: 13px;
    font-weight: 600;
}

.badge-topic {
    background: rgba(102, 126, 234, 0.2);
    color: #a0b5ff;
}

.badge-scope {
    background: rgba(251, 191, 36, 0.2);
    color: #fbbf24;
}

.badge-stance-for {
    background: rgba(16, 185, 129, 0.2);
    color: #6ee7b7;
}

.badge-stance-against {
    background: rgba(239, 68, 68, 0.2);
    color: #fca5a5;
}

.card-section {
    margin-bottom: 32px;
}

.section-label {
    font-size: 12px;
    font-weight: 700;
    color: #667eea;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    margin-bottom: 12px;
}

.section-content {
    color: #d0d0e0;
    font-size: 15px;
    line-height: 1.8;
}

.arguments-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.argument-item {
    background: rgba(255,255,255,0.03);
    border-left: 3px solid #667eea;
    border-radius: 8px;
    padding: 16px;
    color: #d0d0e0;
    font-size: 14px;
    line-height: 1.6;
}

.argument-item.supporting {
    border-left-color: #10b981;
}

.argument-item.opposing {
    border-left-color: #ef4444;
}

.actions-panel {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    border-radius: 16px;
    padding: 32px;
    border: 1px solid rgba(255,255,255,0.1);
    height: fit-content;
    position: sticky;
    top: 100px;
}

.actions-title {
    font-size: 20px;
    font-weight: 700;
    color: white;
    margin-bottom: 20px;
}

.action-btn {
    width: 100%;
    padding: 16px 24px;
    border-radius: 10px;
    font-weight: 600;
    font-size: 15px;
    cursor: pointer;
    border: none;
    margin-bottom: 12px;
    transition: all 0.2s;
    text-decoration: none;
    display: block;
    text-align: center;
}

.btn-publish {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
}

.btn-publish:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4);
}

.btn-edit {
    background: rgba(102, 126, 234, 0.2);
    color: #a0b5ff;
    border: 2px solid rgba(102, 126, 234, 0.3);
}

.btn-edit:hover {
    background: rgba(102, 126, 234, 0.3);
}

.btn-discard {
    background: rgba(239, 68, 68, 0.2);
    color: #fca5a5;
    border: 2px solid rgba(239, 68, 68, 0.3);
}

.btn-discard:hover {
    background: rgba(239, 68, 68, 0.3);
}

.info-box {
    background: rgba(102, 126, 234, 0.1);
    border: 2px solid rgba(102, 126, 234, 0.2);
    border-radius: 12px;
    padding: 16px;
    margin-top: 20px;
}

.info-text {
    font-size: 13px;
    color: #a0b5ff;
    line-height: 1.6;
}

@media (max-width: 1024px) {
    .preview-layout {
        grid-template-columns: 1fr;
    }
    
    .actions-panel {
        position: static;
    }
}
{% endblock %}

{% block content %}
<div class="preview-container">
    <div class="preview-header">
        <div class="header-icon">‚ú®</div>
        <h1 class="header-title">Your Argument Card is Ready!</h1>
        <p class="header-subtitle">Review your card below. You can publish it as-is or edit it first.</p>
    </div>

    <div class="preview-layout">
        <!-- Card Preview -->
        <div class="card-preview">
            <div class="card-header">
                <h2 class="card-title">{{ draft.title }}</h2>
                <div class="card-meta">
                    <span class="meta-badge badge-topic">{{ topic_display }}</span>
                    <span class="meta-badge badge-scope">{{ draft.scope|title }}</span>
                    <span class="meta-badge {% if draft.stance == 'for' %}badge-stance-for{% else %}badge-stance-against{% endif %}">
                        {% if draft.stance == 'for' %}‚úì For{% else %}‚úó Against{% endif %}
                    </span>
                </div>
            </div>

            <div class="card-section">
                <div class="section-label">üìã Hypothesis</div>
                <div class="section-content">{{ draft.hypothesis }}</div>
            </div>

            <div class="card-section">
                <div class="section-label">‚úÖ Supporting Arguments</div>
                <div class="arguments-list">
                    {% for arg in draft.supporting_args %}
                    <div class="argument-item supporting">{{ arg }}</div>
                    {% empty %}
                    <div class="argument-item" style="opacity: 0.5;">No supporting arguments</div>
                    {% endfor %}
                </div>
            </div>

            <div class="card-section">
                <div class="section-label">‚ùå Opposing Arguments</div>
                <div class="arguments-list">
                    {% for arg in draft.opposing_args %}
                    <div class="argument-item opposing">{{ arg }}</div>
                    {% empty %}
                    <div class="argument-item" style="opacity: 0.5;">No opposing arguments</div>
                    {% endfor %}
                </div>
            </div>

            <div class="card-section">
                <div class="section-label">üìù Conclusion</div>
                <div class="section-content">{{ draft.conclusion }}</div>
            </div>
        </div>

        <!-- Actions Panel -->
        <div class="actions-panel">
            <h3 class="actions-title">What's Next?</h3>
            
            <form method="POST" action="{% url 'publish_survey_card' %}">
                {% csrf_token %}
                <button type="submit" class="action-btn btn-publish">
                    üöÄ Publish This Card
                </button>
            </form>
            
            <a href="{% url 'edit_survey_card' %}" class="action-btn btn-edit">
                ‚úèÔ∏è Edit Before Publishing
            </a>
            
            <form method="POST" action="{% url 'discard_survey_card' %}">
                {% csrf_token %}
                <button type="submit" class="action-btn btn-discard" onclick="return confirm('Are you sure you want to discard this card?')">
                    üóëÔ∏è Start Over
                </button>
            </form>

            <div class="info-box">
                <p class="info-text">
                    üí° <strong>Tip:</strong> Your card was generated based on your survey responses. You can publish it as-is or make edits to personalize it further.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
